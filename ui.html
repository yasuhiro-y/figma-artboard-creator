<h2>Artboard Creaator</h2>
<p>
  sheetId:
  <input
    id="sheetId"
    value="1sHT7mWJXjUz0RnuRO8oES56y_JUQAraa_x3loEZjeB8"
    pattern="[a-zA-Z0-9-_]+"
  />

  <label for="wrapEvery">Wrap every:</label>
  <input type="number" name="wrapEvery" value="0" />
  <label for="renderArtboardName">Render artbord name</label>
  <input type="checkbox" name="wrapEvery" value="0" />
</p>
<button id="create">Create</button>
<button id="cancel">Cancel</button>

<script>
  //  get data and run scripts when pressed create
  document.getElementById('create').onclick = () => {
    const textbox = document.getElementById('sheetId')
    const sheetId = textbox.value
    getData(sheetId).then((data) => {
      data = JSON.parse(JSON.stringify(data))
      data = data['feed']['entry']
      parent.postMessage(
        { pluginMessage: { type: 'create', content: data } },
        '*'
      )
    })
  }
  // Close when pressed cancel
  document.getElementById('cancel').onclick = () => {
    parent.postMessage({ pluginMessage: { type: 'cancel' } }, '*')
  }
  // Get data from Spreadsheet ID
  async function getData(id) {
    const url =
      'https://spreadsheets.google.com/feeds/cells/' +
      id +
      '/1/public/full?alt=json'
    let data = await (await fetch(url)).json()
    return data
  }
</script>
